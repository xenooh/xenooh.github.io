name: Deploy to GitHub Pages # 워크플로우 이름 변경

on:
  push:
    branches: [ main ] # main 브랜치에 푸시될 때 워크플로우 실행

jobs:
  build-and-deploy: # 작업 이름 변경
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4 # actions/checkout@v4로 변경

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18' # 사용할 Node.js 버전 지정

      - name: Install dependencies
        run: npm install

      - name: Build React app # 빌드 단계 추가 (환경 변수 주입)
        env:
          REACT_APP_GITHUB_TOKEN: ${{ secrets.API_TOKEN }} # GitHub Secrets에서 토큰 가져와 환경 변수 설정
        run: npm run build

      - name: Deploy to GitHub Pages # 배포 단계 추가
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }} # GitHub Actions 제공 토큰 또는 배포 키
          branch: gh-pages # 배포할 브랜치 (GitHub Pages 설정에 따라 다를 수 있음)
          folder: build # 빌드 결과물 폴더
